import time
from slave.slavex import SlaveX
from frame.serialmodel import SerialModel
import unittest

class TestSlaveX(unittest.TestCase):

    def setUp(self):
        self.testthread = TestThread()
        self.testthread.start()
        # def setup_module(module)
        self.source = SlaveX()
        self.source.start()

    def test_serial_source_write(self):
        self.testthread._write(b"\xEB\x90\x01\x00\x00\x01\x90\xEB")
        time.sleep(0.2)
        print('data', self.source.data)
        assert self.source.data == b'\x01\x00\x00\x01'

    def tearDown(self):
        self.testthread.close()
        self.source.close()


class TestThread(SerialModel):
    """docstring for Source"""
    def __init__(self, ):
        super(TestThread, self).__init__()
        self.running = True
        self.setPort('com15', 9600)
        self.setDaemon(True)





